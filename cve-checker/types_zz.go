// Copyright 2019 Google LLC
//
// Licensed under the Apache License, Version 2.0 (the "License");
// you may not use this file except in compliance with the License.
// You may obtain a copy of the License at
//
//     https://www.apache.org/licenses/LICENSE-2.0
//
// Unless required by applicable law or agreed to in writing, software
// distributed under the License is distributed on an "AS IS" BASIS,
// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
// See the License for the specific language governing permissions and
// limitations under the License.

package main

import "time"

type VulnerabilityDescription struct {
	DiscoverySummary struct {
		Discovery []struct {
			CreateTime time.Time `json:"createTime"`
			Discovered struct {
				AnalysisStatus     string `json:"analysisStatus"`
				ContinuousAnalysis string `json:"continuousAnalysis"`
			} `json:"discovered"`
			Kind        string    `json:"kind"`
			Name        string    `json:"name"`
			NoteName    string    `json:"noteName"`
			ResourceURL string    `json:"resourceUrl"`
			UpdateTime  time.Time `json:"updateTime"`
		} `json:"discovery"`
	} `json:"discovery_summary"`
	ImageSummary struct {
		Digest               string `json:"digest"`
		FullyQualifiedDigest string `json:"fully_qualified_digest"`
		Registry             string `json:"registry"`
		Repository           string `json:"repository"`
	} `json:"image_summary"`
	PackageVulnerabilitySummary struct {
		NotFixedVulnerabilityCount int `json:"not_fixed_vulnerability_count"`
		TotalVulnerabilityFound    int `json:"total_vulnerability_found"`
		Vulnerabilities            struct {
			CRITICAL []Occurences `json:"CRITICAL"`
			HIGH     []Occurences `json:"HIGH"`
			LOW      []Occurences `json:"LOW"`
			MEDIUM   []Occurences `json:"MEDIUM"`
			None     []Occurences `json:"None"`
		} `json:"vulnerabilities"`
	} `json:"package_vulnerability_summary"`
}

type VulnerabilityDetails struct {
	CvssScore    float64 `json:"cvssScore"`
	PackageIssue []struct {
		AffectedLocation struct {
			CpeURI  string `json:"cpeUri"`
			Package string `json:"package"`
			Version struct {
				Name     string `json:"name"`
				Revision string `json:"revision"`
			} `json:"version"`
		} `json:"affectedLocation"`
		FixedLocation struct {
			CpeURI  string `json:"cpeUri"`
			Package string `json:"package"`
			Version struct {
				Kind string `json:"kind"`
			} `json:"version"`
		} `json:"fixedLocation"`
		SeverityName string `json:"severityName"`
	} `json:"packageIssue"`
	Severity string `json:"severity"`
}

type Occurences struct {
	CreateTime           time.Time            `json:"createTime"`
	Kind                 string               `json:"kind"`
	Name                 string               `json:"name"`
	NoteName             string               `json:"noteName"`
	ResourceURL          string               `json:"resourceUrl"`
	UpdateTime           time.Time            `json:"updateTime"`
	VulnerabilityDetails VulnerabilityDetails `json:"vulnerability"`
}
